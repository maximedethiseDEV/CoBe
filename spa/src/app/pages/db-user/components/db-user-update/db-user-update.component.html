<app-header-form [iconHeader]="iconHeader" [labelHeader]="labelHeader"/>

<div class="mt-6 flex-1">
  <form [formGroup]="form" (ngSubmit)="update()">
    <div class="border border-slate-200 divide-y divide-slate-200 rounded-none">
      <app-section-fom [sectionForm]="sections.account">
        <ng-container slot="content">
          <label for="username" class="block text-sm font-medium text-slate-700">
            Pseudo <span class="text-indigo-600">*</span>
          </label>
          <input
            id="username"
            type="text"
            formControlName="username"
            class="mt-1 block w-full bg-white px-3 py-2 text-sm text-slate-900 border border-slate-300 outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-400 transition"
          >

          <label for="password" class="mt-4 block text-sm font-medium text-slate-700">
            Nouveau mot de passe (optionnel)
          </label>
          <input
            id="password"
            type="password"
            formControlName="password"
            class="mt-1 block w-full bg-white px-3 py-2 text-sm text-slate-900 border border-slate-300 outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-400 transition"
          >
        </ng-container>
      </app-section-fom>

      <app-section-fom [sectionForm]="sections.permission">
        <ng-container slot="content">
          <label for="permission" class="block text-sm font-medium text-slate-700">
            Permission <span class="text-indigo-600">*</span>
          </label>
          <select
            id="permission"
            formControlName="permission"
            class="mt-1 block w-full bg-white px-3 py-2 text-sm text-slate-900 border border-slate-300 outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-400 transition"
          >
            <option [ngValue]="'USER'">USER</option>
            <option [ngValue]="'ADMIN'">ADMIN</option>
          </select>
        </ng-container>
      </app-section-fom>

      <app-section-fom [sectionForm]="sections.contact" (createConfig)="onSectionCreateModeChange($event)">
        <ng-container slot="isNew">
          <app-contact-form [form]="contactGroup"/>
        </ng-container>
        <ng-container slot="content">
          <label for="contact" class="block text-sm font-medium text-slate-700">
            Contact <span class="text-indigo-600">*</span>
          </label>
          <select
            id="contact"
            formControlName="contactId"
            class="mt-1 block w-full bg-white px-3 py-2 text-sm text-slate-900 border border-slate-300 outline-none focus:ring-4 focus:ring-indigo-200 focus:border-indigo-400 transition"
          >
            <option [ngValue]="null"></option>
            @for (contact of contacts(); track contact.id) {
              <option [ngValue]="contact.id">
                {{ contact.lastName }} {{ contact.firstName }} - {{ contact.email }}
              </option>
            }
          </select>
        </ng-container>
      </app-section-fom>
    </div>

    <div class="flex justify-end">
      <app-submit-button [disabled]="form.invalid"/>
    </div>
  </form>
</div>
