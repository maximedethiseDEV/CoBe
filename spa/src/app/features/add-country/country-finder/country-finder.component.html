<div class="h-full flex flex-col">
<p-table
  #dt
  [value]="tableData"
  [frozenValue]="previewCountry$ ? [previewCountry$] : []"
  [rows]="50"
  [rowsPerPageOptions]=rowsPerPageOptions
  [globalFilterFields]=globalFilterFields
  stripedRows
  [loading]="loading"
  [scrollable]="true"
  scrollHeight="900px"
  selectionMode="single"
  [(selection)]="selectedCountry"
  [metaKeySelection]="metaKey"
  dataKey="countryId"
  paginator="true"
  responsiveLayout="scroll"
  [tableStyle]=TABLE_STYLE
  (onRowSelect)="onRowSelect($event)"
>

  <ng-template pTemplate="caption">
    <div class="flex justify-left items-center gap-2">
      <p-button severity="secondary" icon="pi pi-filter-slash" (click)="clear(dt)"/>

      <span class="p-input-icon-left">
        <label for="globalFilter"><i class="pi pi-search"></i></label>

        <input
          pInputText
          PSize="Large"
          type="text"
          name="globalFilter"
          id="globalFilter"
          (input)="applyGlobalFilter($event)"
          placeholder="Rechercher..."
        />
      </span>
    </div>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="countryName">
        Nom
        <p-sortIcon field="countryName"></p-sortIcon>
      </th>
      <th pSortableColumn="countryCode">
        Code
        <p-sortIcon field="countryCode"></p-sortIcon>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="frozenbody" let-country let-rowIndex="rowIndex">
    <tr
      [pSelectableRow]="country"
      [pSelectableRowIndex]="rowIndex"
      class="font-bold bg-blue-50 cursor-pointer"
    >
      <td class="whitespace-nowrap overflow-hidden text-ellipsis">{{ country.countryName }}</td>
      <td class="whitespace-nowrap overflow-hidden text-ellipsis">{{ country.countryCode }}</td>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-country let-rowIndex="rowIndex">
    <tr
      [pSelectableRow]="country"
      [pSelectableRowIndex]="rowIndex"
      class="transition-colors hover:bg-indigo-100 cursor-pointer"
    >
      <td class="whitespace-nowrap overflow-hidden text-ellipsis">{{ country.countryName }}</td>
      <td class="whitespace-nowrap overflow-hidden text-ellipsis">{{ country.countryCode }}</td>

    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td colspan="5" class="text-center p-4">
        Aucun country trouv√©
      </td>
    </tr>
  </ng-template>
</p-table>

  <app-country-summary
    *ngIf="selectedCountry"
    [country]="selectedCountry"
    [(visible)]="displayDialog"
    (copyToForm)="copyCountryToForm($event)"
  ></app-country-summary>

</div>
